<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cronômetro Controlado</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin-top: 50px;
            color: steelblue;
        }
        .timer {
            font-size: 2em;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="timer" id="cronometro">00:00.000</div>

    <script>
        // Variável para controlar o cronômetro
        let coletaPare = true;

        // Variáveis internas
        let timerInterval; // Armazena o intervalo
        let startTime; // Marca o início do cronômetro
        let elapsedTime = 0; // Tempo acumulado em milissegundos

        // Função para formatar o tempo como MM:SS.mmm
        function formatTime(ms) {
            const minutes = Math.floor(ms / 60000);
            const seconds = Math.floor((ms % 60000) / 1000);
            const milliseconds = ms % 1000;
            return `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}.${String(milliseconds).padStart(3, '0')}`;
        }

        // Função para atualizar o cronômetro
        function updateTimer() {
            const now = Date.now();
            const timePassed = now - startTime + elapsedTime;
            document.getElementById('cronometro').textContent = formatTime(timePassed);
        }

        // Função para iniciar o cronômetro
        function startTimer() {
            if (!timerInterval) {
                startTime = Date.now(); // Marca o momento em que o cronômetro foi iniciado
                timerInterval = setInterval(updateTimer, 10); // Atualiza a cada 10ms
            }
        }

        // Função para parar o cronômetro
        function stopTimer() {
            if (timerInterval) {
                clearInterval(timerInterval);
                timerInterval = null;
                elapsedTime += Date.now() - startTime; // Acumula o tempo já decorrido
            }
        }

        // Monitorar a variável "coletaPare"
        setInterval(() => {
            if (coletaPare && !timerInterval) {
                startTimer(); // Inicia o cronômetro quando coletaPare é true
            } else if (!coletaPare && timerInterval) {
                stopTimer(); // Para o cronômetro quando coletaPare é false
            }
        }, 100); // Verifica a cada 100ms
    </script>
</body>
</html>
